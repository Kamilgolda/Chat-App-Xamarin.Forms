<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1 style="float:left">
        Interfejsy plików HTML5
    </h1>
    <img src="img/interfaces.png" style="float:left" />
    <h1>

        Interfejs FileReader
    </h1>
    <img src="img/filereader.png" />
    <h2>
        FileReader odczytuje zawartość asynchronicznie i uruchamia eventy w celu wskazania postępu
        ładowania operacji.
    </h2>
    <ul>
        <li><h4><strong>progress</strong> aby wskazać postęp.</h4></li>
        <li><h4><strong>load</strong> że dane zostały pomyślnie załadowane.</h4></li>
        <li><h4><strong>abort</strong> że ładowanie danych zostało przerwane</h4></li>
        <li><h4><strong>error</strong> że wystąpił błąd podczas ładowania.</h4></li>
        <li>
            <h4>
                <strong>loadend</strong> że operacja odczytu została zakończona, pomyślnie lub
                bezskutecznie.
            </h4>
        </li>
    </ul>
    <h1>
        Czytanie pliku tekstowego
    </h1>
    <img src="img/readfile.png" style="float:right" />
    <h3>
        Funkcja FileReader readAsText () umożliwia
        czytać plik tekstowy w lokalnym systemie plików.
    </h3>
    <h4>
        Strona internetowa zawiera element input, który
        umożliwia użytkownikowi wybranie pliku tekstowego na komputerze lokalnym
        system plików. Jak tylko użytkownik wybierze
        plik, funkcja onLoadTextFile () odczytuje plik
        i wyświetla jego zawartość jako zwykły tekst w
        textarea na stronie internetowej.
    </h4>
    <textarea rows="30" cols="100">
<input type="file" id="theTextFile"
       onchange="onLoadTextFile()" />

&lt;textarea id="theMessageArea" rows="30" cols="40">&lt;/textarea&gt;

    &lt;script type="text/javascript">
    function onLoadTextFile() {
        const theFileElem = document.getElementById("theTextFile");
        // Get the File object selected by the user, and make sure it is a text file.
        if (theFileElem.files.length != 0 && theFileElem.files[0].type.match(/text.*/)) {
            // Create a FileReader and handle the onload and onerror events.
            const reader = new FileReader();
            reader.onload = function (e) {
                const theMessageAreaElem = document.getElementById("theMessageArea");
                theMessageAreaElem.value = e.target.result;
            };
            reader.onerror = function (e) {
                alert("Cannot load text file");
            };
            // Read text file (the second parameter is optional - the default encoding is "UTF-8").
            reader.readAsText(theFileElem.files[0], "ISO-8859-1");
        } else {
            alert("Please select a text file");
        }
    }
    &lt;/script&gt;
</textarea>
    <textarea id="theMessageArea" rows="30" cols="40" style="float:left"></textarea>
    <input type="file" id="theTextFile"
           onchange="onLoadTextFile()" />

    <h1>Odczytywanie pliku binarnego</h1>

    <textarea rows="30" cols="100">
<input type="file" id="theBinaryFile" onchange="onLoadBinaryFile()" />

<img id="theImage"></img>

<script type="text/javascript">
    function onLoadBinaryFile() {
        const theFileElem = document.getElementById("theBinaryFile");
        // Get the File object selected by the user (and make sure it is an image file).
        if (theFileElem.files.length != 0 && theFileElem.files[0].type.match(/image.*/)) {
            // Create a FileReader and handle the onload and onerror events.
            const reader = new FileReader();
            reader.onload = function (e) {
                const theImgElem = document.getElementById("theImage");
                theImgElem.src = e.target.result;
            };
            reader.onerror = function (e) {
                alert("Cannot load binary file");
            };
            // Read the binary file.
            reader.readAsDataURL(theFileElem.files[0]);
        } else {
            alert("Please select a binary file");
        }
    }
</script>
</textarea>
    <input type="file" id="theBinaryFile" onchange="onLoadBinaryFile()" />
    <img id="theImage"></img>

    <h1>Drag-and-Drop</h1>

    <h3>
        Obiekt DataTransfer definiuje atrybuty i metody, które pozwalają kontrolować wszystkie aspekty
        przeciągnij i upuść:
    </h3>
    <h4>
        setData (mimeType, data) określa typ MIME przesyłanych danych oraz same dane.
        Możliwe jest przechowywanie kilku różnych elementów w obiekcie DataTransfer, o ile wszystkie mają
        różne typy MIME.
    </h4>
    <h4>
        setDragImage (imgElement, x, y) określa niestandardowy obraz kursora myszy, którego będzie używać przeglądarka
        podczas operacji przeciągania i upuszczania.
    </h4>
    <h4>
        effectAllowed ogranicza rodzaj operacji przeciągania i upuszczania, takie jak copy, move lub
        link.
    </h4>
    <h4>
        dropEffect określa informację zwrotną, którą otrzymuje użytkownik, gdy wskaźnik myszy znajdzie się nad celem
        element. Atrybutem dropEffect może być none, copy, move lub link.
    </h4>
    <h3>Poniższy przykład pokazuje, jak przeciągać element div:</h3>
    <textarea rows="10" cols="80">
        <div id="drag1" draggable="true" ondragstart="handleDrag(event)">
        <b>Some content</b> to be dragged.
        </div>

<script type="text/javascript">
    function handleDrag(ev) {
        ev.dataTransfer.effectAllowed = "copy";
        ev.dataTransfer.setData("text/plain", ev.target.innerHTML);
    }
</script>
</textarea>

    <h1>Upuszczanie treści na elemencie div</h1>
    <h2>Aby element sterujący działał jako cel upuszczenia, musi obsłużyć zdarzenie upuszczenia.</h2>
    <h3>
        Metoda getData () oczekuje
        Typ MIME danych do pobrania, które mają zostać dostarczone jako parametr.
    </h3>
    <h3>
        Gdy użytkownik upuszcza dane do kontrolki, która może obsługiwać zdarzenia upuszczenia, domyślnym zachowaniem jest nawigacja do
        danych, które zostały upuszczone. Jeśli użytkownik upuści adres URL, przeglądarka przejdzie na ten adres; jeśli użytkownik
        upuszcza obraz, przeglądarka wyświetli obraz. Jeśli użytkownik upuści kawałek tekstu, przeglądarka to zrobi
        spróbuj traktować ten tekst jako adres URL i najprawdopodobniej wygeneruje błąd nieprawidłowego adresu URL. Dlatego w większości przypadków trzeba wyłączyć to domyślne zachowanie
    </h3>
    <h3>
        W funkcji obsługi zdarzenia drop wywołaj metodę preventDefault() na obiekcie, który wywołał
        wydarzenie.
        Możesz także zapobiec przedostawaniu się kolejnych zdarzeń upuszczania do drzewa DOM, wywołując funkcję
        stopPropagation () na obiekcie zdarzenia.
    </h3>
    <h3>
        Kontrolki mogą również obsługiwać zdarzenie przeciągania, które występuje, gdy użytkownik przeciąga element nad kontrolką
        bez upuszczania. Często używa się tego zdarzenia do zmiany kursora, aby wskazać, że sterowanie może
        działać jako cel zrzutu.
    </h3>
    <textarea rows="20" cols="100">
        <div id="div1" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" style="width:336px;height:69px;border:1px solid blue"></div>


    <script type="text/javascript">
        function handleDragOver(event) {
            event.stopPropagation();
            event.preventDefault();
            event.dataTransfer.dropEffect = "copy"; // Display a "copy" cursor
        }
        function handleDrop(event) {
            event.stopPropagation();
            event.preventDefault();
            event.target.innerHTML = event.dataTransfer.getData("text/plain");
        }
</script>
</textarea>

    <div id="div1" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" style="width:336px;height:69px;border:1px solid blue"></div>
    <br>
    <div id="drag1" draggable="true" ondragstart="handleDrag(event)" width="336" height="69"><b>Some content</b> to be dragged.</div>

    <script>
        function handleDragOver(event) {
             event.stopPropagation();
            event.preventDefault();
            event.dataTransfer.dropEffect = "copy"; // Display a "copy" cursor
        }

        function handleDrag(ev) {
            ev.dataTransfer.effectAllowed = "copy";
            ev.dataTransfer.setData("text/plain", ev.target.innerHTML);
        }

        function handleDrop(event) {
            event.stopPropagation();
            event.preventDefault();
            event.target.innerHTML = event.dataTransfer.getData("text/plain");
        }
    </script>

</body>

















            <script type="text/javascript">
                function onLoadTextFile() {
            const theFileElem = document.getElementById("theTextFile");
            // Get the File object selected by the user, and make sure it is a text file.
            if (theFileElem.files.length != 0 && theFileElem.files[0].type.match(/text.*/)) {
                // Create a FileReader and handle the onload and onerror events.
                const reader = new FileReader();
                reader.onload = function (e) {
                    const theMessageAreaElem = document.getElementById("theMessageArea");
                    theMessageAreaElem.value = e.target.result;
                };
                reader.onerror = function (e) {
                    alert("Cannot load text file");
                };
                // Read text file (the second parameter is optional - the default encoding is "UTF-8").
                reader.readAsText(theFileElem.files[0], "ISO-8859-1");
            } else {
                    alert("Please select a text file");
            }
        }


           function onLoadBinaryFile() {
const theFileElem = document.getElementById("theBinaryFile");
// Get the File object selected by the user (and make sure it is an image file).
if (theFileElem.files.length != 0 && theFileElem.files[0].type.match(/image.*/))
{
// Create a FileReader and handle the onload and onerror events.
const reader = new FileReader();
reader.onload = function(e){
const theImgElem = document.getElementById("theImage");
theImgElem.src = e.target.result;
};
reader.onerror = function(e){
                    alert("Cannot load binary file");
};
// Read the binary file.
reader.readAsDataURL(theFileElem.files[0]);
}
else
{
                    alert("Please select a binary file");
}
}
    </script>
</html>